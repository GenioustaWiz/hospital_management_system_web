{% block css %}
<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/jquery-datetimepicker/2.5.20/jquery.datetimepicker.min.css">
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-datetimepicker/2.5.20/jquery.datetimepicker.full.min.js"></script>

<style>
    p{
        margin-bottom: 5px !important;
    }
    select{
        border: 1px solid #c9e6ff;
      }
      .phone-no{
        display: flex;
        padding-top: 0 !important;
      }
      .phone-no select{
        width: 70px;
        margin-right: 5px;
      }
      select.P-no{
        width: fit-content;
      }
      .date-time{
        display: flex;
        justify-content: space-between;
      }
      .date-time p{
        max-width: 115px;
      }
      .text-area p{
        display: flex;
        flex-direction: column;
      }
      textarea{
        height: 70px;
      }
</style>
{% endblock css %}
<div class="div2">
    <div>
        <h5 >+Book Appointment</h5>
    </div>
    <div class="form">
        <form method="post">
            {% csrf_token %}
            {{ form1.as_p }}
            <div id="phone-no" style="padding-top: 10px;">
                
                <label for="id_phone_number">Phone number:</label>
                
                <p class="phone-no">
                 {{form2.phone}}
                </p>
                <script>
                  document.addEventListener("DOMContentLoaded", function () {
                      // Get the select element
                      var select = document.getElementById("id_phone_0");
          
                      // Initialize a variable to store the previous selected option text
                      var previousOptionText = "";
          
                      // Initialize a variable to store the index of the option currently displaying in the
                      // select. before selecting a new option
                      var currentIndex = -1;
                      // Function to update the previousOptionText and currentIndex variables
                      function updateSelection() {
                          var selectedOption = select.options[select.selectedIndex];
                          var fullText = selectedOption.textContent;
                          // Use a regular expression to extract the country code (last part)
                          var countryCodeMatch = fullText.match(/\+\d+$/);
                          if (countryCodeMatch) {
                              var countryCode = countryCodeMatch[0];
                              // Update the text of the selected option to display only the country code
                              selectedOption.text = countryCode;
                              //console.log(selectedOption)
                              previousOptionText = fullText;
                              currentIndex = select.selectedIndex;
                          }
                      }
          
                      // Initial update
                      updateSelection();
          
                      // Add an event listener for the "change" event on the select element
                      select.addEventListener("change", function () {
                          // Get the selected option text
                          var selectedOptionText = select.options[select.selectedIndex].text;
          
                          // Do something with the selected option text, e.g., save it to a variable
                          //console.log("Selected Option Text:", selectedOptionText);
          
                          // Do something with the previous option text if needed
                          //console.log("Previous Option Text:", previousOptionText);
          
                          // Do something with the current index if needed
                          //console.log("Current Index:", currentIndex);
          
                          // You can also replace the text of the current select option with the saved text
                          select.options[currentIndex].text = previousOptionText;
          
                          // Update the previousOptionText and currentIndex variables
                          updateSelection();
                      });
                  });
                </script>
            </div>
            <div class="date-time">
                {{ form3.as_p }}
            </div>
            {% comment %} <input type="text" id="id_date" name="date">
            <input type="text" id="id_time" name="time"> {% endcomment %}
            <div class="text-area" style="padding-top: 10px;">
            {{ form4.as_p }}
            </div>
            <div class="form-group button">
                <button type="submit">Submit</button>
            </div>
            <p class="text-center" style="margin-bottom: 0 !important;">or</p>
            <div class="form-group button" style="margin-top: 5px;">
              <a href="" id='whatsapp-url' target="_blank" style="font-weight: 700;">Text on Whatsapp</a>
            </div>
        </form>
    </div>
</div>